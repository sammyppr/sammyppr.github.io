---
marp: true
theme: default
size: 16:9
paginate: true
headingDivider: 2
header: メディア表現III 14.最適化
footer: ""
---

# メディア表現III<!-- omit in toc -->
> 14.最適化

# 目次<!-- omit in toc -->
1. [最終課題について](#最終課題について)
2. [今日のトピック](#今日のトピック)
   1. [コンピュータの仕組み](#コンピュータの仕組み)
   2. [データの整理](#データの整理)
   3. [編集の順番](#編集の順番)
   4. [プリレンダリング](#プリレンダリング)
   5. [再生時の解像度](#再生時の解像度)
   6. [メモリ](#メモリ)
   7. [Lumetriスコープ](#lumetriスコープ)
   8. [プロキシ](#プロキシ)
   9. [まとめ](#まとめ)

# 初めに<!-- omit in toc -->

# 前回のおさらい<!-- omit in toc -->
映像の一部分を切り取る
- マスク
- キーイング
- ロトスコープ

にて学びました。

# 最終課題について

---
### 今後の予定
- 14回目：7/14
- 15回目：7/21
- 定期試験：8/1-8/6

最終課題の締切日は7/31とします。

---
### 最終課題について
以下の二つの課題をNASに提出してください。(smb://nas1-mc.thu.ac.jp, 2022演習-メディア表現III-最終課題提出-学籍番号フォルダ)

#### 1. MOGRTを作成せよ。
10回目の「モーショングラフィックステンプレートの制作」を参考にオリジナルのMOGRTを作成せよ。AE,MOGRTの両ファイルを提出すること
　
#### 2. モーショングラフィックスをテーマを選択して作成せよ
8,9,11,12回目からテーマを選択し、オリジナルのモーショングラフィックスを作成せよ。複合でももちろん構わない。AE,MP4の両ファイルを提出すること

---
### 最終課題の狙い
Premiere/AfterEffectsの表現力を上げることがこの演習の狙いです。
Premiereに関して学んだことに関しては、映像デザイン演習で役立ててください。
最終課題に関してはAfterEffectsに絞って課題設定しました。

どうしてもよく理解できていない人は、授業中に提示した動画を参考に作成してみましょう。

# 今日のトピック
最適化

---
### コンピュータ速くなった...
それに伴い、できることも増えています。
ということは、計算スピードがさらに求められる様になっています。

コンピュータがなんでもすぐに処理してくれれば便利ですが、世の中まだその様にはなっていません。

スペックに応じて、どのようにコンピュータを扱っていくべきか、そのあたりについて説明していきたいと思います。

---
### 危惧
スマホのアプリでは、トラブルが起きないように、
スマホの性能に合わてできることが調整されていることが多いです。

そのため、「あー、ここまでやるとコンピュータは苦しいと思うのか」という感覚が皆さんから薄れている気がします。

コンピュータは万能ではないので、うまく付き合うことを覚えてほしいです。

<!--
Premiere
https://nakajimovie.com/premiere-proxy/
https://yasunari-shigemoto.org/premiere-pro-rendering/
https://minesuke-design.com/2020/03/13/premiere-pro-%E9%81%85%E3%81%84%E6%99%82%E3%81%AB%E8%A9%A6%E3%81%97%E3%81%9F%E3%81%84%E3%81%93%E3%81%A8/

AfterEffects
https://helpx.adobe.com/jp/after-effects/using/improve-performance.html
https://movie-academy.net/ae_kankyou_4point
https://izuka-effects.com/aftereffects-speed-up/
https://ae-doctor.com/basics-ae-settings/
https://no-rules.site/design/aftereffects-howto/

-->
## コンピュータの仕組み

---
### コンピュータの仕組み
おさらいしましょう。
- CPU: 複雑な計算を処理する
- GPU: 単純な計算を処理する
- メモリ：結果などを一時的に蓄える
- HDD/SSD：ファイルや計算結果(キャッシュ)を保存

[Mythbusters Demo GPU versus CPU](https://www.youtube.com/watch?v=-P28LKWTzrI)

---
### リソースは有限
リソースは有限のものです。どの様にこれを効率化させて利用するかをきちんと考えましょう。

---
### コンピュータの状態の把握
Macではアクティビティモニターと呼ばれるアプリが標準で付いてきます。
Windowsではタスクマネージャーと呼ばれます。

コマンド+スペースで「act」くらいでもアクティビティモニタは出ますし、
アプリケーション - ユーティリティの中にあります。

---
### アクティビティモニタ
CPU/メモリ/エネルギー/ディスク/ネットワーク

の状態を見ることができますが、CPU,GPUの状態を
- CPUの使用率
- CPUの履歴
- GPUの履歴

でも見ることができます。
これにより、どのくらいコンピュータが苦しんでいるかがわかります。

アプリによって、うまく全て使えない場合もあります。

---
### 一般論
たくさんのアプリを同時に立ち上げると、それだけでリソースを取り合います。
映像編集において
- Photoshop
- Illustrator
- Premiere Pro
- AfterEffects
- Audition

あたりが随時立ち上がっていると楽ですが、コンピュータが苦しんでいる様であれば、不要なものを終了しましょう。
または、作業の切り分けを行い、同時に多くのアプリが起動しない様にしましょう。

## データの整理

---
### 素材データ
データの整理はきちんと行えているでしょうか？
撮影を行うと
- NGテイク

が相当数存在することが多いです。

いらない素材データは使わないので消しましょう。
Premiereでの作業前に整理することをお勧めします。

- HDD/SSDのスペースを開けることができる
- Premiereに管轄させないことで余計な処理を減らすことができる
- そもそも、混乱しない

---
### タグづけ
Macではファイルにタグ(色)をつけることができます。
撮影した後に、
- 緑：使う
- 黄：使うかも
- 赤：NG

と分類しておき、取り込むのは緑、必要に応じて黄としておくと良いでしょう。


## 編集の順番

---
### 編集で大事なこと
映像は
- Full HD: 1920 * 1080
- 4K: 3840 * 2160

のデータですが、編集時には画質を確認する時(質感・粒子感)以外は、フレームがスムーズに見えることの方が重要です。

---
### 編集の順番
エフェクト・カラコレ・カラグレを行うにつれ、カクツキが生じることがあります。

つまり、「カラコレ・カラグレ」等は同じカメラで撮影された素材を扱う時には一番最後にすることでカット編集においては負荷を避けることができます。

---
### エフェクトと調整レイヤー
調整レイヤーにエフェクト(カラコレ・カラグレ)をかけることで、「処理が重くなった」というときには、調整レイヤーをオフにすることもできます。

## プリレンダリング

---
### プレビューが重いとき
シーケンスの上に色がついていて
- 緑: プリレンダリング済み
- 黄: レンダリングされていないがプレビュー問題なし
- 赤: レンダリングされていないがプレビュー問題あり

の色がついていて、レンダリングの状態、および、リアルタイムプレビューが可能かどうかが表示されています。

---
### プリレンダリング
プリレンダリングすると、あらかじめ計算するため、スムーズに再生することが可能になります。

ただし、再度編集すると、もう一度プリレンダリングが必要となってしまいます。

---
### プリレンダリングとシーケンス
プリレンダリングはシーケンスに対して行われます。

そのため、
1. カット編集するシーケンス
2. エフェクトをかけるシーケンス
3. カラコレ・カラグレをかけるシーケンス

を別にすることによって、別々のシーケンスとすることができますから、別々にプリレンダリングをしておくことができます。

これにより、コンピュータの負荷を下げることができます。

## 再生時の解像度

---
### 再生時に何をみたいか
先ほども言ったように、編集時には画質を確認する時(質感・粒子感)以外は、フレームがスムーズに見えることの方が重要です。

> ウィンドウ- フレームを最大化

を行えばある程度大きくなりますが、それでも4K画像は全てを確認できません。

---
### コンピュータがやっていること
1. シーケンスの設定に合わせてフレームの画像を計算
2. 表示されている画像エリアに合わせて縮小表示

となります。これって、負荷かけてますね。

---
### 再生時の解像度
ですから、再生時の解像度を下げてあげれば、コンピュータへの負荷は減ります。特に、MBA,MBPで作業している場合、そもそも右上の1/4位に見えている状態では、全ての解像度を確認できません。

そのため、再生時の解像度をコンピュータの稼働状況に応じて
- フル画質
- 1/2
- 1/4
- 1/8
- 1/16

と下げてあげることでスムーズに再生することが可能となります。

## メモリ

---
### メモリの使い方
皆さんのメモリは8Gに人が多いかと思いますが、人によっては16G/32Gの人もいるでしょう。

これの使い方を環境設定で設定することができます。

---
### メモリの設定
メモリはOSや他のソフトでも利用します。そのため、どういう配分で利用するかを設定できます。

通常は触る必要はありません。

---
### レンダリングの最適化
- パフォーマンス
- メモリ

を選ぶことができます。Adobeでは

> 大量のメモリを消費するようなレンダリングであれば、この設定をメモリにしてください。
そしてそのレンダリングが終わったら、パフォーマンスに戻してください。

とアナウンスしています。

## Lumetriスコープ

---
### Lumetriスコープ
カラーコレクション・カラーグレーディングをする時には必須ですが、このグラフの表示には計算が必要です。

再生がカクツクようであれば、閉じてみましょう。

## プロキシ

---
### 今日の本題
4Kの画像はそもそもが重いです。
FullHDに比べて縦横とも2倍の解像度があるため、4倍の情報量を扱うことになります。

しかも、再生時にそれ全部を見ているかというと、そうでもないことが多いです。

---
### 処理を軽くするために
ならば、素材のファイルをそもそも解像度を落として編集し、
最後のレンダリングの時に高画質で書き出せれば問題はないですね。

そこで、プロキシ(代理)という考え方が出てきます。

---
### プロキシ
実験を行ってみました。

http://footage3.openspc2.org/HDTV/footage/4K/30f/

から、4K映像をダウンロードします。
1. プロジェクトを作成
2. 映像を登録
3. シーケンスにドロップ
4. 映像を右クリックで「プロキシ-作成」
5. プログラムの+ボタンで「プロキシの切り替え」を追加

---
### フォルダ構成
そのままの設定にしたので、元素材と同じレベルに「Proxies」 フォルダが作成され、その中にプロキシファイルが作成されました。

- 元: sample.r3d 1.06G 3840x2160
- プロキシ: sample.mp4 18.1M 1024x540

そりゃ、処理が軽くなります。

---
### アクティビティモニタ
HDMI接続してうまくいくかわかりませんが、
実験してみましょう。

プロキシを使った場合とそうでない場合で、どのようにコンピュータが動作しているか確認できます。

## まとめ

---
### まとめ
PremiereProをメインで扱いましたが、コンピュータを効率的に扱うと、スペックの低いマシンでも編集は可能です。

20年前はSD(640x480)という解像度でしたが、その頃からいかに誤魔化して編集をするか、は課題でした。

いろいろな技を使って、なるべく快適に作業していきましょう。

---
### 参考になりそうなサイト
#### Premiere Pro
https://nakajimovie.com/premiere-proxy/
https://yasunari-shigemoto.org/premiere-pro-rendering/
https://minesuke-design.com/2020/03/13/premiere-pro-%E9%81%85%E3%81%84%E6%99%82%E3%81%AB%E8%A9%A6%E3%81%97%E3%81%9F%E3%81%84%E3%81%93%E3%81%A8/

#### AfterEffects
https://helpx.adobe.com/jp/after-effects/using/improve-performance.html
https://movie-academy.net/ae_kankyou_4point
https://izuka-effects.com/aftereffects-speed-up/
https://ae-doctor.com/basics-ae-settings/
https://no-rules.site/design/aftereffects-howto/


