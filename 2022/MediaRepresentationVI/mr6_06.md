# メディア表現 VI 6. モダンExcel

[メディア表現 VI TOP に戻る](./index.md)

---

## 目次<!-- omit in toc -->

- [メディア表現 VI 6. モダンExcel](#メディア表現-vi-6-モダンexcel)
  - [今日利用するデータ](#今日利用するデータ)
  - [モダンExcel?](#モダンexcel)
  - [コンピュータ演習のおさらい・モダンExcelに入る前に知っておいてほしいこと](#コンピュータ演習のおさらいモダンexcelに入る前に知っておいてほしいこと)
    - [Officeのバージョンについて](#officeのバージョンについて)
      - [Macの人](#macの人)
      - [Windowsの人](#windowsの人)
    - [見方](#見方)
      - [製品エディション](#製品エディション)
      - [数字](#数字)
    - [ピボットテーブル](#ピボットテーブル)
      - [単純集計の方法](#単純集計の方法)
      - [クロス集計の方法](#クロス集計の方法)
    - [テーブル](#テーブル)
    - [スピル](#スピル)
  - [きりがいいから...](#きりがいいから)
  - [提出について](#提出について)

---

## 本日の内容<!-- omit in toc -->
- 【第5回】モダンExcelI 従来のセルとは異なるモダンExcelについて学修する。
- 【第6回】モダンExcelII を用いた分析・可視化について学修する。

4回目に特別講師の方の話が入っているため、二つまとめてやってしまおうかと思いましたが、やはりゆっくりやった方が良いと思いましたので、今回、来週の2回でモダンExcelを学修していきたいと思います。

---
## 今日利用するデータ
ダウンロードして解凍してください。
- [mr6_06.xlsx.zip](mr6_06.xlsx.zip)

---
## モダンExcel?
コンピュータ演習にてExcelを学びましたが、非常に初歩的な内容でした。コンピュータ演習IIを取った人はもう少しやっているかもしれません。

Excelではいわゆる「表計算」としての機能の他に集計などをすることができます。

そして、過去のやり方とは異なり、より**簡単にデータの収集や分析**が行える「モダンExcel」と呼ばれる機能がついています。

「モダンExcel」といわれるのに重要な機能は
- Power Query(パワークエリー)
- Power Pivot(パワーピボット)

という機能であり、実はExcel2010あたりからアドイン(追加するプラグインのようなもの)で対応していましたが、Excel2016から標準搭載しています。

これにより複雑なデータ解析を誰でも行えるようになっています。

マイクロソフトでは「PowerBI」というBI(ビジネス・インテリジェンス)ツールサービスも提供しています。
モダンExcelの知識は最終的にPowerBIの利用にも役立つ知識となっています。

以前はいろんな関数や、VBA(Visual Basic for Application...プログラミング言語)を利用しなければいけなかったことが、「ノーコード」「ローコード」にて利用できるようになっています。

> ノーコード・ローコード
> アプリケーションなどの開発を行う際にコードを書かない、もしくは少ないコードでも開発ができるというものです。

前回Airtableを利用した際も、本当は「SQL言語」を使ってデータベースを操作するところ、あっという間にWebのフォームアプリケーションまで作成できました。
プログラミングによる開発も個人的にはまだまだ重要だと考えていますが、「ノーコード」「ローコード」の流れは止まらないと考えています。
楽にできることは楽に処理しましょう。

## コンピュータ演習のおさらい・モダンExcelに入る前に知っておいてほしいこと
1年生からまともにExcelに触っていない人も多いかと思います。
おさらいから始めましょう。

---
### Officeのバージョンについて
Officeの基本的な機能を使うだけであれば、そんなに細かくバージョンについて知る必要がありません。
ところが、新しい機能は新しいバージョンでなければ利用できません。まずはバージョンの確認方法について知りましょう。(網羅できてるか不安ですが...)

ちょっと、全員のバージョン確認したいので、TeamsにOSとバージョン、ライセンスを貼ってみてください。

#### Macの人
Excelを起動して、**Excelメニュー**から**バージョン情報**を確認しましょう。
ライセンス、バージョンのところを見てください。

#### Windowsの人
新規でなんかファイル開いて、**ファイル-アカウント**で「ライセンス認証された製品」「バージョン情報」のところ見てください。

### 見方
#### 製品エディション
- Microsoft Office Home
- Microsoft Office Professional
- Microsoft Office Business

などさまざまなエディションがあります。

#### 数字
- 2003
- 2007
- 2010
- 2013
- 2016
- 2019
- 2021

等3年おきに大きなバージョンが出ています。
これは発売された年を表しています。

- Microsoft 365(さんろくご)...古くはOffice365

というのがあります。
これは、Microsoftが提供しているクラウドサービスの名称で年代ではありません。
これば、最新のOffice製品をダウンロードしても使えるという仕様になっています。
バージョンは「最新版」としか言いようがありません。(一応数字ついてますけど)

最新版のため機能は頻繁に拡張されています。

わかりにくいですが
- 年代のついているもの：永続ライセンスでありずっと使えるがどんどん古くなっていく
- Microsoft 365：サブスクリプションで常に最新の機能が利用できる

という風になっています。

---
### ピボットテーブル
集計方法について少し説明します。
> 単純集計
> 設問毎に回答結果を集計し、何人が回答したのか、各選択肢の内訳はどうなのかを表示する手法

> クロス集計
> 2つ以上の質問項目の回答内容をかけ合わせ、回答者属性ごとの反応の違いを見るようなときに用いる集計方法

#### 単純集計の方法
mr6_06.xlsxを開いて「単純集計」シートを開いてください。
集計の表を埋めてみましょう。

え、ヒント？
COUNTIFを使ってみましょう。絶対参照も覚えていますか？

答え
<p style="color:#151515">
<dl>
<dt style="color:#151515">F5</dt><dd style="color:#151515">=COUNTIF($B$5:$B$24,E5)</dd>
<dt style="color:#151515">F6</dt><dd style="color:#151515">上からオートフィル</dd>
<dt style="color:#151515">F7</dt><dd style="color:#151515">=SUM(F5:F6)</dd>
<dt style="color:#151515">G5</dt><dd style="color:#151515">=F5/$F$7</dd>
<dt style="color:#151515">G6,G7</dt><dd style="color:#151515">上からオートフィル</dd>
</dl>
</p>

#### クロス集計の方法
mr6_06.xlsxを開いて「単純集計」シートを開いてください。

集計の表を作るにはどうしますか？

関数を用いると非常に面倒くさいです。
I,Sを選択して右クリックで「再表示」を選んでみましょう。

考え方だけ説明します。
1. 答えと性別をくっつけたデータを作る
2. COUNTIFでそれを数えて、後は適当に合計させます。

文字列同士をくっつけるには
- &
- CONCAT
- CONCATNATE

を使います。多少違いますが説明割愛します。

面倒臭いですね。ここでピボットテーブルという便利な機能があります。(まだモダンExcelではない)

1. JからRを選択して「表示しない」
2. A4からC24を選択
3. 挿入タブからピボットテーブル
4. 作成先を既存のワークシートにしてT4をクリック,OK
5. ピボットテーブルのフィールドが出てくる
6. **答え**をドラッグして列に
7. **性別**をドラッグして行に
8. **個人ID**をドラッグして値に
9. **合計/個人ID**の「i」をクリック
10. 合計を個数にしてOK

関数など面倒くさいこと考えずに集計されたことがわかったでしょうか？

ピボットテーブルは集計に便利です。もっと色々なことができます。ぜひ興味ある人は見てみましょう。

[ピボットテーブルの使い方！【図解付き】基本から応用まで分かりやすく解説](https://mainichi.doda.jp/article/2019/03/06/1479.html)

---
### テーブル
「テーブル」シートを選択しましょう。

あれ、Q1と同じですね。

21番目のデータを追加してみてください。

集計結果変わりませんね。集計結果の式を変更しますか？
面倒くさいですよね。

こんな時に「テーブル」という機能もあります。使ってみましょう。

1. 21番目のデータを一旦削除
2. A4からB24を選択
3. 挿入タブからテーブル,OK
4. 21番目のデータを入れてみましょう。

テーブルにしたら、集計結果変わりましたね。でも、ちょっと気持ち悪いですね。絶対参照なのに勝手に変わるなんて。もう一回やってみましょう。

5. 集計2に計算式を入れていきます。
6. Q1と同様にやってみましょう。F12,F13のみで構いません
7. 式が「=COUNTIF(テーブル1[答え],E12)」 になっていませんか？
8. 22番目のデータを入れてみましょう。

テーブルを利用するのであれば、絶対参照より式として「テーブル使ってるよ」と分かるように

1. 表をテーブルに
2. それを元に集計

とした方が、後で混乱しなくて良いと思います。

テーブルの便利さはわかりましたか？

---
### スピル
Excel2021, Microsoft365から利用できる機能です。

これまで、セルに計算式を入力すると、そのセルのみに値が入っていました。

> スピル
> 数式を入力したセルだけでなく、隣接するセルにも結果が表示される(スピルとは溢れる・溢れるという意味)

意味わかりませんね。やってみましょう。

「スピル」シートを選択してください。

1. これまでA2からA5をB2からB5に式でコピーしたいときはB2に「=A2」としてオートフィルを使っていました。
2. B2に「=A2:A5」と打ってみましょう。
3. B3,B4,B5を見ると、計算式グレーですね。「ゴースト」と呼びます。
4. 試しにB3を「=1」としてみましょう
5. エラー出ましたね。ここには、式を入力していないからそうなっている、ということになります。
6. スピルの合計を知りたいときはどうしたら良いでしょうか？
7. C2に「=SUM(B2#)」としてみましょう。
8. #をセル名の後につけることで、スピルの範囲を選べることがわかりますね。
9. 表がテーブルだとどうなるでしょうか？
10. A1からA5を選択してテーブルにしましょう。
11. A6に500と入力してみましょう。反応しますね。

スピルをもう少し実践的に使ってみるために、九九の表を作ってみましょう。

1. B11に「=B10:J10*A11:A19」

え、これだけでいいんですか！！！

スピルの便利さわかったでしょうか？



## きりがいいから...
Excelには楽な機能がたくさんあることが理解できたでしょうか？
モダンExcelの機能、PowerQuery,PowerPivotについてはまだ入っていませんが、きりが良いので今日はここまでとしましょう。


## 提出について
今日は作業したExcelのファイル名を学籍番号に変えて、それで提出としましょう。
