---
marp: true
theme: default
size: 16:9
paginate: true
headingDivider: 3
header: "インターネット基礎理論 06 インターネットの仕組み"
math: true
---

# インターネット基礎理論 06<br>インターネットの仕組み

## はじめに
### 資料置き場
![bg right width:10cm](img/01_qr.png)
https://sammyppr.github.io

に授業資料を置いていきます。復習に使ってください。

欠席した場合などはスライドを確認して追いつくようにしましょう。

> スライドあるなら授業受けなくていいや

なんてことは思わないようにお願いします。

### コンピュータ基礎理論
前回はインターネットの歴史について学びました。
今回は、仕組みについて学んでいきましょう。

## インターネットの仕組み
### インターネットとは
前回のおさらいをすると、インターネットはネットワークどうしをつないだもの、ということでした。

インターネットプロトコル(IP)という全てのコンピュータが話せる言葉を利用して、通信が行われている、ということまでは説明しました。

### 人間世界で例えると？
- **Q** このように、複数のコンピュータ間にて通信が行われている状況を、人間世界で例えるとどのようになるでしょうか？
- **A** 電話がわかりやすいかな？

### 電話の仕組み
電話を利用するときに必要なことが２つあります。
それは、
- 相手の電話番号を知っていること
- 相手と同じ言葉をしゃべること

です。

もし、相手の電話番号を知らなければ、相手と接触することができません。

もし、相手がアフリカ語を話していたら、会話になりません。

### 電話番号とは
では、まず電話番号について考えてみましょう。

電話番号は、普段利用するのに気づかないかもしれませんが、

```
0-市外局番-市内局番-加入者番号
```

のような仕組みになっています。海外のことを考えれば、国コードがつきますね。

ちなみに、日本の国コードは81です。

このように電話番号を振ることによって、一つ一つの電話が「個」として認識され、電話をかけることができるわけです。

### 電話番号とインターネットの関係
さて、電話番号について再認識したところで、インターネットとどう関係があるのでしょうか。

簡単ですね。電話番号の代わりに、インターネット用の番号を振ればよいのです。このことを

```
IPアドレス
```
と呼びます。

### IPアドレス
電話番号と同じように、全てのコンピュータには一つの番号が付けられています。
その形式は、2進数で表記すると

```
11111101111100111110110011001101
```

のように、2進法で32桁、1桁で扱える情報が1bitだったので、つまり、

- 32bit

の情報で表します。

### IPアドレス
ま、わかりづらいですよね。ので、8bitずつ4つの塊で

```
11111101.11110011.11101100.11001101
```

と表記します。これでも分かりづらいですよね。

ので、2進法の代わりに10進法を用いて

```
253.243.236.205
```

のように表記します。

ここまでくると、見たことある人もいるかもしれません。
家庭でインターネットプロバイダに接続するときに送られてくる資料にこのような数字が並んでいます。

### iPhoneやMacのIPアドレスを確認してみよう
当然、MacもiPhoneもIPアドレスが振られています。確認してみましょう。

### IPアドレスで表せる量
32bitであらわせる状態は$2^{32}$=4,294,967,296で、約40億です。

つまり、インターネットが認識できるコンピュータの数は約40億となります。膨大な数で想像できませんね。

---
あれ、全世界の総人口って何人でしたっけ？

---
なんと、
```
76億人(米国勢調査局と国連データからの推計)
```
です。

### あれ？足りるの？
携帯電話も一人1台、ないしは2台持ちなんて人がいます。

コンピュータは家にあったり、大学・会社にもあります。最近では、テレビもインターネットにつながるようになってしまっています。

そうすると、一人何台ものコンピュータを持っていることになりますので、膨大と思われた40億の番号では足りないですね。

### さて、どうしよう？
これでは、全てのコンピュータが接続することができません。

さて、どうしましょうか？

### IPv4からIPv6へ
ということで、これまでは

```
IPv4
```
という方式でIPアドレスを振っていましたが、これからは

```
IPv6
```
というこれまでの32bitから**128bit**に拡張されたアドレスを利用するようになってきています。

### 1人あたりにすると
これによって、割り振ることのできるIPアドレスは

```
約340澗(かん)個 = 約340兆×1兆×1兆個
```

となり、その辺の石ころ全てに割り振ってもまだ余るといわれています。
これにより、IPアドレスの枯渇を気にすることはなくなります。

1人あたり

> 4京8,600兆×1兆個 = 4.86×$10^{28}$個

なので、十分ですよね。

### IPv6の問題点
これで、利用できるコンピュータが飛躍的に伸びたことは間違いありませんが、問題点もあります。

- IPv4とIPv6は直接話ができない\pause
- 全てのコンピュータがIPv6にいつ対応するのか？\pause

という問題です。

よって、当分の間はIPv4,IPv6が共存していくことになっています。

- [IPv6とIPv4の混在期は当分続く、習得したい3つの「共存技術」](https://xtech.nikkei.com/atcl/nxt/column/18/02811/041700004/)

### IPv6表記方法
IPv6では128bitでアドレスを表しますが、人間がわかりやすいようにするために

> 16bitを8つの塊で区切り、一つの塊を１６進法で表記し、区切り文字を「:」とする

ということになっています。

```
2001:0db8:bd05:01d2:288a:1fc0:0001:10ee
```
のような形式です。(全然わかりづらいけど...128桁の2進数よりマシ...)

### ネットワークエンジニアになりたい人向け
IPv6の本は無料で公開されています。

- [プロフェッショナルIPv6（無料版）](https://booth.pm/ja/items/913273)

492ページもあります。

### 電話の話に戻します
さて、電話には「内線電話」と呼ばれるものがあります。
これをインターネットで模したものを

> プライベート・アドレス

と呼びます。
家庭などで利用する場合には、これを利用していることが非常に多いです。

### LAN(家庭を例にとります)
家庭内でコンピュータどうしが通信するには、その中でだけ一意にコンピュータを識別できれば十分です。

よって、家庭内では大抵の場合、プライベート・アドレスを利用して、家庭内LANを形成します。

これらは、
> 192.168.XXX.YYY
等というアドレスが多く利用されます。(XXX,YYYは0から255)

### LANにおけるルーターの役割
> ブロードバンドルータ

と呼ばれる機械が設置されている家庭も多いかと思います。

これが、家庭内LANとインターネットを接続する時に非常に大事な役割を持っています。

### ルータとは？
ルータは英語で

> router

で、英語では「ルート(route)」は「道」を意味しますから、それに「r」がついて、

> 物を送る道筋を決める人

ということになります。

つまり、家庭内LANの情報を、どのようにインターネットへ送り出せばよいかを決める係がルータなのです。

### IPアドレスの振り方
IPアドレスは皆が勝手に利用したのでは、ぶつかってしまい、混乱してしまいます。(同じ電話番号を勝手に利用できないのと同じ)

ですので、IPアドレスを管理している団体がいます。

そして、割り当てられたIPアドレスをそれぞれのコンピュータに設定していきます。

### サブネットマスク
詳しくは説明しませんが、

> サブネットマスク
というものもあります。

これからネットワークの構成(現在いるネットワークの規模等)が理解できます。

### ゲートウェイアドレス
> ゲートウェイアドレス
というものもあります。

これは先程説明したルーター、つまり、外部との接点を表すものとなっています。

### ネットワークの設定に必要な情報
まとめると
- IPアドレス
- サブネットマスク
- ゲートウェイアドレス
- DNSサーバ(後述します)

の情報があって初めてインターネットに接続することができます。

### 動画
ここまでの動画を見てみましょう。
- [ルータとは（ネットワーク機器）](https://www.youtube.com/watch?v=z89rTLvImrM)

### 設定方法
具体的な設定方法は割愛しますが、コントロールパネルのネットワーク設定等を利用して設定します。

```
そんなの設定しないけどコンピュータ使えてるよ
```
、って人いません？

### DHCP
かつては全部手作業で設定する必要がありましたが、
- **DHCP** Dynamic Host Configuration Protocol

という技術によって、インターネットを利用するだけのコンピュータには自動的に番号が割り振られるようになっています。

### 話を戻して…
最初に電話で会話するには
-  相手と同じ言葉をしゃべること
が２つ目の条件と説明しました。

インターネットを成立させるために非常に重要な役割をしているのが

```
TCP(Transmission Control Protocol)
```

といわれるものです。

### TCP
TCPとは、
```
インターネットでデータ送ったって正しく送られるかわかんないよね
```
という前提で情報を送ります。そのため、ミスがあったとしても情報を正確につたえることができます。

```
データ来てないので、もう一回送って
```
と通信しあっているからです。(7回目にもう少し詳しく...)

### ここまでのおさらい
インターネットでは
- IP
- TCP

という２つの技術が非常に大事なため、この２つをまとめて、

> インターネット・プロトコル・スイーツ

と呼び、２つセット、で

> TCP/IP

と呼びます。

## ドメインネーム
### 話題変えるよ
さて、これまでの話だと、コンピュータには一意のIPアドレスが振られていて、そこにアクセスするには

```
203.243.48.135
```
という番号を利用するということを学んできました。

これでは、あのホームページにアクセスする時に、この数字を覚えていなくてはなりません。

**覚えてられないですよね！**

### ドメインネーム
というわけで、ドメイン・ネームというものを利用することにしました。

googleのコンピュータにアクセスするには

> www.google.co.jp

にアクセスすればよい、ということになります。

これは、実際には

> 172.217.31.131

というIPアドレスにあります(変わるかもだけど)。
ので、確認してみましょう。

### ターミナル(Winならコマンドプロンプト)
> $ nslookup www.google.co.jp

としてみましょう。アドレスが返ってくるはず...

### ドメインネームサーバ(DNS)
さて、ではなぜwww.google.co.jpのIPアドレスがわかったのでしょうか？

簡単に言えば、

```
電話帳の役割をするシステムが動いているから
```

ということになり、このシステムのことを

> ドメインネームサーバ(DNS)
と呼びます。

先ほど、設定に必要といったのはこのドメインネームサーバのことです。

### ドメインネームサーバの仕組み
世の中にはネットワークの数以上のドメインネームサーバがあります。

そして、インターネットの利用には必ず一つ以上のドメインネームサーバのIPアドレスを知っておく必要があります。

そして、ドメインネームが要求されると、ドメインネームサーバに対して
```
このドメインネームのIPアドレスってなーに？
```
とお伺いを立てます。すると、IPアドレスを教えてくれるわけです。

### ドメインネームサーバはどうやってIPアドレスを知るのか？
世の中には数億台以上のコンピュータが接続されていると考えられます。

これを全て管理するのは大変ですよね？

さて、どうしましょう？

### ドメインネームサーバは自身のネットワークの情報のみ保持
一つのドメインネームサーバが管理するのは、そのドメインに関連することだけです。

例えば本大学であれば

> thu.ac.jp

というドメインネームを利用していますが、これに対して情報を保持しているドメインネームサーバが存在しています。

逆に、これ以外の情報は保持していません。

### ドメインネームサーバは互いにつながっている
そこで、知らないドメインネームが聞かれた時には、知ってそうなドメインネームサーバに

```
このドメインネームのIPアドレス教えて！
```
とまた聞きをすることになっています。

そうすることで、一つのドメインネームサーバに対する負荷を削減することが可能になっています。

### サブドメイン
同一ドメイン内でコンテンツを区別する為に利用されるのが

> サブドメイン

です。本学であれば、

```
www.thu.ac.jp
```

というのがサブドメインで、そのwwwという名前からホームページ用のサブドメインであることがわかります。

```
manaba.thu.ac.jp
```
であれば、manaba用のサブドメインです.

### ちなみに
- **jp** 日本 japan
- **ac** 教育機関 academic

という意味であり、それぞれ定義されています。

そのため、ドメインネームを見ることで、それがどのネットワークのものかを知ることが容易になっています。

### こぼれ話1
.tvというドメインを利用できる国がありました。どこでしょう？
.
.
.

ツバルというオセアニアにある国です。

あまり裕福な国ではなかったために、この.tvの利用権を米国の会社に5000万ドルで売却しました。

その資金を元に2000年に国連に加盟をしました。

### こぼれ話2
- [ネット初期時代に見られたドメインネーム戦争](https://www.gizmodo.jp/2014/11/post_15979.html)

### URL
- **URL** Uniform Resource Locator

インターネット上の情報を取得するための場所とアクセス方法を指定するものです。

```
http://www.thu.ac.jp/campus/nakano.html
```
とあれば、

> www.thu.ac.jpの
> /campus/nakano.htmlにある情報を
> httpという方法で取得したい

という意味になります。


## 時間あまっていたら...
- 本大学のログイン環境について
- ポート
- PPP

## 小レポート
データをインターネット上でやり取りする仕組みについて説明せよ。(manaba)


