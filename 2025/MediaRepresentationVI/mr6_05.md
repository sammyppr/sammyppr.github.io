# メディア表現 VI 5. モダンExcel

[メディア表現 VI TOP に戻る](./index.md)

---

## 目次<!-- omit in toc -->

- [メディア表現 VI 5. モダンExcel](#メディア表現-vi-5-モダンexcel)
  - [今日利用するデータ](#今日利用するデータ)
  - [Excel 初級・中級・上級の目安](#excel-初級中級上級の目安)
  - [モダンExcel?](#モダンexcel)
  - [Excel等の現状](#excel等の現状)
    - [Officeのバージョンについて](#officeのバージョンについて)
      - [Macの人](#macの人)
      - [Windowsの人](#windowsの人)
    - [見方](#見方)
      - [製品エディション](#製品エディション)
      - [数字](#数字)
      - [サブスクリプション](#サブスクリプション)
      - [Microsoft Copilot](#microsoft-copilot)
    - [更新の仕方](#更新の仕方)
      - [Mac](#mac)
      - [Win](#win)
    - [Microsoft 365 on Web(紹介)](#microsoft-365-on-web紹介)
    - [Power Platform(紹介)](#power-platform紹介)
  - [コンピュータ演習のおさらい・モダンExcelに入る前に知っておいてほしいこと](#コンピュータ演習のおさらいモダンexcelに入る前に知っておいてほしいこと)
    - [計算式](#計算式)
    - [絶対参照](#絶対参照)
    - [VLOOKUPやってみよう](#vlookupやってみよう)
  - [Excelの便利な機能(コンピュータ演習範囲外)](#excelの便利な機能コンピュータ演習範囲外)
    - [ピボットテーブル](#ピボットテーブル)
      - [単純集計の方法](#単純集計の方法)
      - [クロス集計の方法](#クロス集計の方法)
    - [テーブル](#テーブル)
    - [スピル](#スピル)
  - [Excelを利用する上での考え方](#excelを利用する上での考え方)
  - [おまけ](#おまけ)
  - [提出について](#提出について)

---

## 本日の内容<!-- omit in toc -->
- 【第5回】モダンExcelI 従来のセルとは異なるモダンExcelについて学修する。

---
## 今日利用するデータ
ダウンロードして解凍してください。
- [test2020.xlsx.zip](./file/test2020.xlsx.zip)
- [mr6_05.xlsx.zip](mr6_05.xlsx.zip)

---
## Excel 初級・中級・上級の目安
「Excel使えます」というにはどの程度できればいいのでしょうか？
1年生の時に学んだ内容だと自信を持ってExcel使えます、とはなりません。

<!--
- [事務職でExcelはどこまでできればOK？初級・中級・上級をレベル別に解説](https://job-cube.com/blog/topics/8180/)
-->

- [Excel（エクセル）スキルの初級、中級、上級とは？学習方法も解説](https://biz.moneyforward.com/work-efficiency/basic/16919/)

中級の内容ができれば、わりと胸を張って「Excel使えます」ということができます。事務職狙いの人は、学んでおいた方が良いでしょう。


---
## モダンExcel?
コンピュータ演習にてExcelを学びましたが、非常に初歩的な内容でした。コンピュータ演習IIを取った人はもう少しやっているかもしれません。

Excelではいわゆる「表計算」としての機能の他に集計などをすることができます。

そして、過去のやり方とは異なり、より**簡単にデータの収集や分析**が行える「モダンExcel」と呼ばれる機能がついています。

「モダンExcel」といわれるのに重要な機能は
- Power Query(パワークエリー)
- Power Pivot(パワーピボット)

という機能であり、実はExcel2010あたりからアドイン(追加するプラグインのようなもの)で対応していましたが、Excel2016から標準搭載しています。(Macは違うけど...)

これにより複雑なデータ解析を誰でも行えるようになっています。

マイクロソフトでは「PowerBI」というBI(ビジネス・インテリジェンス)ツールサービスも提供しています。
モダンExcelの知識は最終的にPowerBIの利用にも役立つ知識となっています。

以前はいろんな関数や、VBA(Visual Basic for Application...プログラミング言語)を利用しなければいけなかったことが、「ノーコード」「ローコード」にて利用できるようになっています。

> ノーコード・ローコード
> アプリケーションなどの開発を行う際にコードを書かない、もしくは少ないコードでも開発ができるというものです。

前回Airtableを利用した際も、本当は「SQL言語」を使ってデータベースを操作するところ、あっという間にWebのフォームアプリケーションまで作成できました。Omniを利用すると、本当にあっという間でした。

プログラミングによる開発も個人的にはまだまだ重要だと考えていますが、「ノーコード」「ローコード」の流れは止まらないと考えています。
当然、AIについてもとまりませんね。

楽にできることは楽に処理しましょう。


---
## Excel等の現状

### Officeのバージョンについて
Officeの基本的な機能を使うだけであれば、そんなに細かくバージョンについて知る必要がありません。
ところが、新しい機能は新しいバージョンでなければ利用できません。まずはバージョンの確認方法について知りましょう。(網羅できてるか不安ですが...)

<!-- ちょっと、全員のバージョン確認したいので、TeamsにOSとバージョン、ライセンスを貼ってみてください。-->

#### Macの人
Excelを起動して、**Excelメニュー**から**バージョン情報**を確認しましょう。
ライセンス、バージョンのところを見てください。

#### Windowsの人
新規でなんかファイル開いて、**ファイル-アカウント**で「ライセンス認証された製品」「バージョン情報」のところ見てください。

### 見方
#### 製品エディション
- Microsoft Office Home
- Microsoft Office Professional
- Microsoft Office Business

などさまざまなエディションがあります。

#### 数字
- 2003
- 2007
- 2010
- 2013
- 2016
- 2019
- 2021
- 2024

等3年おきに大きなバージョンが出ています。
これは発売された年を表しています。

#### サブスクリプション
- Microsoft 365(さんろくご)...古くはOffice365

というのがあります。
これは、Microsoftが提供しているクラウドサービスの名称で年代ではありません。
これば、最新のOffice製品をダウンロードしても使えるという仕様になっています。
バージョンは「最新版」としか言いようがありません。(一応数字ついてますけど)

最新版のため機能は頻繁に拡張されています。

わかりにくいですが
- 年代のついているもの：永続ライセンスでありずっと使えるがどんどん古くなっていく
- Microsoft 365：サブスクリプションで常に最新の機能が利用できる

という風になっています。

#### Microsoft Copilot
officeにもAIが来ています。
2023から導入が始まり、2025/9までに個人でも利用できるようになっています。(はず！)
AIアシスタントにより、分析などもできるようになっています。
が、今回は紹介に留めます(今は見ません...)

Excelの基本知識ないと、指示出しできないからです。

- [【緊急】Microsoft365のExcelにデフォルトでCopilotが追加されたので使い方解説します！](https://www.youtube.com/watch?v=k8PShH8JhJs)

### 更新の仕方
#### Mac
「ヘルプ - 更新プログラムのチェック」から最新に更新しましょう。
#### Win
- [Microsoft Update で Office を更新する](https://support.microsoft.com/ja-jp/office/microsoft-update-%E3%81%A7-office-%E3%82%92%E6%9B%B4%E6%96%B0%E3%81%99%E3%82%8B-f59d3f9d-bd5d-4d3b-a08e-1dd659cf5282){:target="_blank"}

### Microsoft 365 on Web(紹介)
- [Web 上で Word、Excel、PowerPoint などを無料で使用](https://www.microsoft.com/ja-jp/microsoft-365/free-office-online-for-the-web){:target="_blank"}

Web上で利用できる、Word, Excel, PowerPointなどです。
機能限定版のように思えますが、Web版から機能を追加したりしていることもあります(デスクトップ版が後)。ってことは最新版？？？

- [「Excel」に「Power Automate」ボタン、作業の自動化が容易に ～まずはWeb版に展開](https://forest.watch.impress.co.jp/docs/news/1537211.html){:target="_blank"}

### Power Platform(紹介)
法人契約しないと利用できない模様ですが、Microsofがこちらを推進しているように見受けられます。

- [Power Platformとは？できること、やってみたことをまとめました](https://www.jbsvc.co.jp/useful/windows10/what-is-powerplatform.html){:target="_blank"}

---
---

## コンピュータ演習のおさらい・モダンExcelに入る前に知っておいてほしいこと
1年生からまともにExcelに触っていない人も多いかと思います。
おさらいから始めましょう。

### 計算式
- セルに「=」に続けて関数を入力することで計算できましたね。


### 絶対参照
覚えていますか？
- オートフィル機能を計算式に対して使うときに、移動して欲しくないセルを「$A$1」の様に記述することです。
- WinではF4、MacではCommand+Tでしたね。fnキーを押しながらF4でも利用できます。
- ショートカットを押すごとに「絶対参照→複合参照（行）→複合参照（列）→相対参照」と変わっていきます。

### VLOOKUPやってみよう
クラスによって、教わった人とそうでない人いると思うのですが[test2020.xlsx](file/test2020.xlsx.zip)を開いて
> 商品一覧表のデータからVLOOKUPを使ってドリンク名を計算式で入力してみよう。

ヒント
- =VLOOKUP(検索値,範囲,列番号) とのヒントがある
- 検索値はコード
- 範囲は商品一覧表
- 列番号は左から2番目

なお、VLOOKUPの新しいバージョンXLOOKUPが利用できるようになっています。
- [XLOOKUP関数の使い方、具体例と実践方法](https://products.sint.co.jp/topsic/blog/excel-xlookup)

---
---

## Excelの便利な機能(コンピュータ演習範囲外)
### ピボットテーブル
集計方法について少し説明します。
> 単純集計
> 設問毎に回答結果を集計し、何人が回答したのか、各選択肢の内訳はどうなのかを表示する手法

> クロス集計
> 2つ以上の質問項目の回答内容をかけ合わせ、回答者属性ごとの反応の違いを見るようなときに用いる集計方法

#### 単純集計の方法
mr6_05.xlsxを開いて「単純集計」シートを開いてください。
集計の表を埋めてみましょう。

え、ヒント？
COUNTIFを使ってみましょう。絶対参照も覚えていますか？

答え
<p style="color:#151515">
<dl>
<dt style="color:#151515">F5</dt><dd style="color:#151515">=COUNTIF($B$5:$B$24,E5)</dd>
<dt style="color:#151515">F6</dt><dd style="color:#151515">上からオートフィル</dd>
<dt style="color:#151515">F7</dt><dd style="color:#151515">=SUM(F5:F6)</dd>
<dt style="color:#151515">G5</dt><dd style="color:#151515">=F5/$F$7</dd>
<dt style="color:#151515">G6,G7</dt><dd style="color:#151515">上からオートフィル</dd>
</dl>
</p>

#### クロス集計の方法
mr6_05.xlsxを開いて「クロス集計」シートを開いてください。

この集計の表を作るにはどうしますか？

関数を用いると非常に面倒くさいです。
I,Sを選択して右クリックで「再表示」を選んでみましょう。

考え方だけ説明します。
1. 答えと性別をくっつけたデータを作る
2. COUNTIFでそれを数えて、後は適当に合計させます。

文字列同士をくっつけるには
- &
- CONCAT
- CONCATNATE

を使います。多少違いますが説明割愛します。

面倒臭いですね。ここでピボットテーブルという便利な機能があります。(まだモダンExcelではない)

1. JからRを選択して「表示しない」
2. A4からC24を選択
3. 挿入タブからピボットテーブル
4. 作成先を既存のワークシートにしてT4をクリック,OK
5. ピボットテーブルのフィールドが出てくる
6. **答え**をドラッグして列に
7. **性別**をドラッグして行に
8. **個人ID**をドラッグして値に
9. **合計/個人ID**の「i」をクリック
10. 合計を個数にしてOK

関数など面倒くさいこと考えずに集計されたことがわかったでしょうか？

ピボットテーブルは集計に便利です。もっと色々なことができます。ぜひ興味ある人は見てみましょう。

[ピボットテーブルの使い方！【図解付き】基本から応用まで分かりやすく解説](https://mainichi.doda.jp/article/2019/03/06/1479.html)

---
### テーブル
「テーブル」シートを選択しましょう。

あれ、Q1と同じですね。

21番目のデータを追加してみてください。

集計結果変わりませんね。集計結果の式を変更しますか？
面倒くさいですよね。

こんな時に「テーブル」という機能もあります。使ってみましょう。

1. 21番目のデータを一旦削除
2. A4からB24を選択
3. 挿入タブからテーブル,OK
4. 21番目のデータを入れてみましょう。

テーブルにしたら、集計結果変わりましたね。でも、ちょっと気持ち悪いですね。絶対参照なのに勝手に変わるなんて。もう一回やってみましょう。

5. 集計2に計算式を入れていきます。
6. Q1と同様にやってみましょう。F12,F13のみで構いません
7. 式が「=COUNTIF(テーブル1[答え],E12)」 になっていませんか？
8. 22番目のデータを入れてみましょう。

テーブルを利用するのであれば、絶対参照より式として「テーブル使ってるよ」と分かるように

1. 表をテーブルに
2. それを元に集計

とした方が、後で混乱しなくて良いと思います。

テーブルの便利さはわかりましたか？

---
### スピル
Excel2021, Microsoft365から利用できる機能です。

これまで、セルに計算式を入力すると、そのセルのみに値が入っていました。

> スピル
> 数式を入力したセルだけでなく、隣接するセルにも結果が表示される(スピルとは溢れる・溢れるという意味)

意味わかりませんね。やってみましょう。

「スピル」シートを選択してください。

1. これまでA2からA5をB2からB5に式でコピーしたいときはB2に「=A2」としてオートフィルを使っていました。
2. B2に「=A2:A5」と打ってみましょう。(=と入力後、A2からA5をドラッグでもOK)
3. B3,B4,B5を見ると、計算式グレーですね。「ゴースト」と呼びます。
4. 試しにB3を「=1」としてみましょう
5. エラー出ましたね。ゴーストが使ってるから計算式入力するな！という意味です。
6. スピルの合計を知りたいときはどうしたら良いでしょうか？
7. C2に「=SUM(B2#)」としてみましょう。
8. #をセル名の後につけることで、スピルの範囲を選べることがわかりますね。
9. 表がテーブルだとどうなるでしょうか？
10. A1からA5を選択してテーブルにしましょう。
11. A6に500と入力してみましょう。反応しますね。

スピルをもう少し実践的に使ってみるために、九九の表を作ってみましょう。

1. B11に「=B10:J10*A11:A19」

え、これだけでいいんですか！！！

スピルの便利さわかったでしょうか？

## Excelを利用する上での考え方
ここまで、Excelのいろんな機能について説明してきました。(モダンExcelには入れていないですが)

実際にデータを集計するときのことを考えてみましょう。
- 毎日の各支店での商品の売り上げ個数のデータ

これを集計するには、自分が今何の作業をしているのかを明確に理解して考える必要があります。

1. 入力データ：元データの準備
2. 計算：抽出・分類・計算・加工
3. 出力：なんらかの成果物

なんのためにデータを操作しているのかを明確に意識しましょう。簡単にいうと
- 後で情報を処理するためのデータを作成している(入力)
- 人が見やすいデータを作成している(出力)

後者の場合は、見やすければ良いですが、前者(入力データ)ではやってはいけないことがあります。

- はセル結合するな

です。

- [あなたのそれ、間違ってますよ。Excelには、正しい使い方があるんです！](https://www.youtube.com/watch?v=BFJMzjlFpMw&t=640s)

この考えをしっかり持った上で、次週いよいよモダンExcelに入っていきましょう。

今日わかったように、新しいことを使えるようになると、作業自体は楽になっていきます。

## おまけ
<!--
### Microsoft Teams
Microsoft Teams Classicを利用している人いますか？
これは廃止となるので、新しいTeamsをインストールするようにしましょう。

- [従来の Teams クライアントの提供の終了](https://learn.microsoft.com/ja-jp/microsoftteams/teams-classic-client-end-of-availability)

### AIについて
- ChatGPT for Excelというアドインを導入すると無料でAI機能を追加できるのですが、OpenAIのAPIキーを入力する必要があります。(無料枠あるけど、結局どっかから有料)
- Copilot Pro(有料)を導入することで、AI機能を利用することができるようになります。

VBAなどはAIに作成を手伝ってもらった方が早く組めるかもしれません。
-->
時間あれば、先ほどのCopilot見てみましょう。

---
## 提出について
今日は作業したExcel(mr6_05.xlsx)のファイル名を学籍番号に変えて、それをmanaba提出としましょう。


